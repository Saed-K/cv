const translations = {
  en: {
    // Header
    profileTitle: "",
    // About Me
    aboutMeTitle: "About Me",
    aboutMeText:
      "A positive, efficient and responsible person with a background in computer science and IT. I have experience in both technical and customer service-related roles.",
    workExperienceContainerTitle: "Work Experience",
    projectsHeader: "Below are some of my IT projects:",
    projectsFooter: "Aside from designing this website for my CV, more projects are available on my ",
    projectsFooter2: " page.",

    //experience
    studentAssistantTitle: "Teaching Assistant",
    studentAssistant:
      "I worked as a teaching assistant at Höglundaskolan while I was finishing my degree. I supported and helped students in their daily schooling.",
    hospitalTitle: "Cleaner at the hospital in Växjö",
    hospital:
      "Last summer I worked with the cleaning staff at the hospital in Växjö. I learned a lot about working in a healthcare environment as a cleaner.",
    storeTitle: "Store Worker",
    store:
      "I had a summer job as a store worker at Orientaliska Livsmedelsbutik in 2020 and 2021. My duties included cashier work, cleaning, stocking shelves, sorting, warehousing, and helping customers.",
    itTitle: "IT Technician",
    it: "After receiving my CompTIA A+ certification, I became a certified IT technician and started working with an amazing team of professionals at SPEED in Egypt. My role was to help customers with their technical issues at home and in-store.",
    it2: "Worked with computer repair, computer service (software and hardware), mobile phone service, troubleshooting networks for customers and cashier work",

    // Skills
    skills: "IT Skills",
    projects: "Projects",
    reference: "References",

    // Education
    dataTitle: "Bachelor's Degree in Computer Science",
    data: "At university, I had the opportunity to collaborate with other students in many group projects, where each student had a responsibility and a role in the team. The program covered a wide range of IT topics such as software, hardware, networking, design and mathematics.",
    highSchoolTitle:
      "High School Diploma in Technology; Information & Media Technology",
    highSchool:
      "The technology program was a good foundation for me to improve my IT skills. I also had electives like English 7, Physics 2 and Math 4.",
    certTitle: "CompTIA A+",
    cert: "A certification in IT that covers all the basics that an IT technician would need. Examples of topics it covers: Hardware, Operating Systems, Networking, Hardware and Network Troubleshooting, Security, and Software Troubleshooting.",

    educationTitle: "Education",
    bachelor: "Bachelor in Computer Science",
    certificationA: "CompTIA A+ Certification",
    // Work Experience
    workExperienceTitle: "Work Experience",
    teachingAssistant: "Teaching Assistant",
    hospitalCleaner: "Hospital Cleaner",
    storeAssistant: "Store Assistant",
    itTechnician: "IT Technician",
    // Projects
    projectsTitle: "Projects",
    projectsIntro: "xxx",

    spaProject: "Personal Web Desktop in a Single Page Application (SPA)",

    // References
    referenceBatur: "Head of Department, Local Cleaning in Växjö",
    referenceAlh: "Store Manager in Mellerud",
    // Contact Form
    contactTitle: "Contact Me",
    namePlaceholder: "Your Name",
    emailPlaceholder: "Your Email",
    subjectPlaceholder: "Subject",
    messagePlaceholder: "Your Message",
    sendButton: "Send Message",
    sending: "Sending...",
    // Footer
    copyright: "All rights reserved.",
  },
  sv: {
    // Header
    profileTitle: "",
    // About Me
    aboutMeTitle: "Om Mig",
    aboutMeText:
      "En positiv, effektiv och ansvarande person med en bakgrund inom datavetenskap och IT. Jag har erfarenhet av både tekniska och kundservice-relaterade roller.",
    workExperienceContainerTitle: "Arbetslivserfarenhet",
    projectsHeader: "Nedan följer några av mina IT-projekt:",
    projectsFooter: "Förutom att designa den här webbplatsen för mitt CV, finns fler projekt på min ",
    projectsFooter2: " websida.",

    //experience
    studentAssistantTitle: "Elevassistent",
    studentAssistant:
      "Jag jobbade som elevassistent på Höglundaskolan medan jag avslutade min examen. Jag stöttade och hjälpte elever i deras dagliga skolgång.",
    hospitalTitle: "Lokalvårdare på sjukhuset i Växjö",
    hospital:
      "Förra sommaren jobbade jag som lokalvårdare på sjukhuset i Växjö. Jag lärde mig mycket om att arbeta i en vårdmiljö som lokalvårdare",
    storeTitle: "Butiksarbetare",
    store:
      "Jag hade sommarjobb som butiksarbetare hos Orientaliska Livsmedelsbutik i 2020 och 2021. Mina arbetsuppgifter var bland annat kassaarbete, städning, fylla på hyllorna, sortering, lager och hjälpa kunder.",
    itTitle: "IT-tekniker",
    it: "Efter att jag fått CompTIA A+ certifiering blev jag certifierad IT-tekniker och började arbeta med ett fantastiskt team av proffs på SPEED i Egypten. Min uppgift var att hjälpa kunder med deras tekniska problem hemma och i butiken.",
    it2: "Arbetade med reparation av datorer, datorservice(mjukvara och hårdvara), mobiltelefonservice, felsöka nätverk för kunder och kassaarbete.",

    // Skills
    skills: "IT-kunskaper",
    projects: "Projekt",
    reference: "Referenser",

    // Education
    dataTitle: "Kandidatexamen i Datavetenskap",
    data: "På universitetet hade jag möjligheter att samarbeta med andra studenter i många gruppprojekt, där varje student hade ett ansvar och en roll i teamet. Programmet täckte ett brett spektrum av ämnen inom IT som mjukvara, hårdvara, nätverk, design och matematik.",
    highSchoolTitle:
      "Gymnasieexamen i Teknikprogrammet; Informations- och medieteknik",
    highSchool:
      "Teknikprogrammet var en bra grund för mig för att förbättra mitt kunskaper inom IT. Jag hade även valfritt ämne som Engelska 7, Fysik 2, och Mattematik 4",
    certTitle: "CompTIA A+ Certifiering",
    cert: "En certifiering inom IT där den täcker alla grund som IT-teknikern skulle behöva. Exempel på ämnen som den täcker: Hårdvara, Operativsystem, Nätverk, Hårdvara och nätverksfelsökning, Säkerhet och Programvarufelsökning.",

    educationTitle: "Utbildning",
    bachelor: "Kandidatexamen i Datavetenskap",
    certificationA: "CompTIA A+ Certifiering",
    // Work Experience
    workExperienceTitle: "Arbetslivserfarenhet",
    teachingAssistant: "Lärarassistent",
    hospitalCleaner: "Sjukhus Städare",
    storeAssistant: "Butiksbiträde",
    itTechnician: "IT-tekniker",
    // Projects
    projectsTitle: "Projekt",
    projectsIntro: "xxxx",
    spaProject: "Personal Web Desktop in a Single Page Application (SPA)",

    // References
    referenceBatur: "Avdelningschef lokalvården i Växjö",
    referenceAlh: "Butikschef i Mellerud",

    // Contact Form
    contactTitle: "Kontakta Mig",
    namePlaceholder: "Ditt Namn",
    emailPlaceholder: "Din E-post",
    subjectPlaceholder: "Ämne",
    messagePlaceholder: "Ditt Meddelande",
    sendButton: "Skicka Meddelande",
    skickar: "Skickar...",
    // Footer
    copyright: "Alla rättigheter förbehållna.",
  },
};

window.addEventListener("load", () => {
  // Hide loader
  setTimeout(() => {
    document.querySelector(".loader-container").classList.add("loader-hidden");
  }, 1000);

  // Initialize animations
  const fadeElements = document.querySelectorAll(".fade-in");

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("active");
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.1 }
  );

  fadeElements.forEach((el) => {
    observer.observe(el);
  });

  // Initialize progress bars
  const progressBars = document.querySelectorAll(".progress-fill");
  setTimeout(() => {
    progressBars.forEach((bar) => {
      const width = bar.getAttribute("data-width");
      bar.style.width = width + "%";
    });
  }, 1500);

  // Scroll to top button
  const scrollToTopBtn = document.getElementById("scrollToTop");

  window.addEventListener("scroll", () => {
    if (window.pageYOffset > 300) {
      scrollToTopBtn.classList.add("visible");
    } else {
      scrollToTopBtn.classList.remove("visible");
    }
  });

  scrollToTopBtn.addEventListener("click", () => {
    window.scrollTo({
      top: 0,
      behavior: "smooth",
    });
  });

  // Language switcher
  const languageSwitch = document.getElementById("languageSwitch");
  const languageBtns = document.querySelectorAll(".language-btn");
  let currentLang = localStorage.getItem("language") || "sv";

  // Initialize page with saved language
  document.documentElement.setAttribute("lang", currentLang);
  updateLanguage(currentLang);

  // Add language switching functionality
  languageBtns.forEach((btn) => {
    btn.classList.remove("active");
    if (btn.dataset.lang === currentLang) {
      btn.classList.add("active");
    }

    btn.addEventListener("click", () => {
      const lang = btn.dataset.lang;
      currentLang = lang;

      // Update active button
      languageBtns.forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");

      // Save preference
      localStorage.setItem("language", lang);
      document.documentElement.setAttribute("lang", lang);

      // Update text content
      updateLanguage(lang);
    });
  });

  function updateLanguage(lang) {
    // Update all translatable elements
    document.querySelectorAll("[data-i18n]").forEach((element) => {
      const key = element.getAttribute("data-i18n");
      if (translations[lang][key]) {
        element.textContent = translations[lang][key];
      }
    });

    // Update placeholders
    document.querySelectorAll("[data-i18n-placeholder]").forEach((element) => {
      const key = element.getAttribute("data-i18n-placeholder");
      if (translations[lang][key]) {
        element.placeholder = translations[lang][key];
      }
    });
  }

  const themeSwitch = document.getElementById("themeSwitch");

  themeSwitch.addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem(
      "dark-mode",
      document.body.classList.contains("dark-mode")
    );
  });

  // Check for saved theme preference
  if (localStorage.getItem("dark-mode") === "true") {
    document.body.classList.add("dark-mode");
  }

  const projectCards = document.querySelectorAll(".project-card");

  projectCards.forEach((card) => {
    card.addEventListener("mousemove", (e) => {
      const rect = card.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      const centerX = rect.width / 2;
      const centerY = rect.height / 2;

      const angleX = (y - centerY) / 20;
      const angleY = (centerX - x) / 20;

      card.style.transform = `perspective(4000px) rotateX(${angleX}deg) rotateY(${angleY}deg) scale3d(1.022, 1.022, 1.022)`;
    });

    card.addEventListener("mouseleave", () => {
      card.style.transform =
        "perspective(4000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)";
    });
  });

  // Particle background effect
  const createParticleBackground = () => {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    canvas.style.position = "fixed";
    canvas.style.top = "0";
    canvas.style.left = "0";
    canvas.style.width = "100%";
    canvas.style.height = "100%";
    canvas.style.pointerEvents = "none";
    canvas.style.zIndex = "-1";
    document.body.appendChild(canvas);

    let particles = [];
    const particleCount = 50;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }

    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 2 + 1;
        this.speedX = Math.random() * 0.5 - 0.25;
        this.speedY = Math.random() * 0.5 - 0.25;

        // Choose color based on theme
        this.color = document.body.classList.contains("dark-mode")
          ? "rgba(255, 255, 255, 0.3)"
          : "rgba(0, 50, 100, 0.1)";
      }

      update() {
        this.x += this.speedX;
        this.y += this.speedY;

        if (this.x > canvas.width) this.x = 0;
        else if (this.x < 0) this.x = canvas.width;

        if (this.y > canvas.height) this.y = 0;
        else if (this.y < 0) this.y = canvas.height;
      }

      draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function initParticles() {
      particles = [];
      for (let i = 0; i < particleCount; i++) {
        particles.push(new Particle());
      }
    }

    function connectParticles() {
      const maxDistance = 150;
      for (let i = 0; i < particles.length; i++) {
        for (let j = i; j < particles.length; j++) {
          const dx = particles[i].x - particles[j].x;
          const dy = particles[i].y - particles[j].y;
          const distance = Math.sqrt(dx * dx + dy * dy);

          if (distance < maxDistance) {
            const opacity = 1 - distance / maxDistance;
            ctx.strokeStyle = document.body.classList.contains("dark-mode")
              ? `rgba(100, 150, 255, ${opacity * 0.2})`
              : `rgba(0, 50, 100, ${opacity * 0.1})`;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y);
            ctx.stroke();
          }
        }
      }
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      particles.forEach((particle) => {
        particle.update();
        particle.draw();
      });

      connectParticles();
      requestAnimationFrame(animate);
    }

    // Update particle colors when theme changes
    themeSwitch.addEventListener("click", () => {
      particles.forEach((particle) => {
        particle.color = document.body.classList.contains("dark-mode")
          ? "rgba(255, 255, 255, 0.3)"
          : "rgba(0, 50, 100, 0.1)";
      });
    });

    initParticles();
    animate();
  };
  // Create particle background if the browser has enough performance
  if (
    !/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
      navigator.userAgent
    )
  ) {
    createParticleBackground();
  }

  const contactButton = document.getElementById("contactButton");
  const contactModal = document.getElementById("contactModal");
  const closeModal = document.querySelector(".close-modal");
  const contactForm = document.getElementById("contactForm");
  const formStatus = document.getElementById("formStatus");

  contactButton.addEventListener("click", () => {
    contactModal.classList.add("active");
    document.body.style.overflow = "hidden";
  });

  // Close modal when close button is clicked
  closeModal.addEventListener("click", () => {
    contactModal.classList.remove("active");
    document.body.style.overflow = "";
  });

  // Close modal when clicking outside the modal content
  contactModal.addEventListener("click", (e) => {
    if (e.target === contactModal) {
      contactModal.classList.remove("active");
      document.body.style.overflow = "";
    }
  });

  // Handle form submission
  contactForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(contactForm);
    const data = Object.fromEntries(formData);

    // Show loading state
    const submitBtn = contactForm.querySelector(".submit-btn");
    const originalText = submitBtn.textContent;
    submitBtn.textContent = currentLang === "en" ? "Sending..." : "Skickar...";
    submitBtn.disabled = true;

    try {
      const response = await fetch("https://formspree.io/f/xyzezpnb", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" },
      });

      await new Promise((resolve) => setTimeout(resolve, 1000));

      formStatus.textContent =
        currentLang === "en"
          ? "Message sent successfully!"
          : "Meddelandet har skickats!";
      formStatus.className = "form-status success";
      contactForm.reset();

      // Hide success message and close modal after 3 seconds
      setTimeout(() => {
        formStatus.style.display = "none";
        contactModal.classList.remove("active");
        document.body.style.overflow = "";
      }, 3000);
    } catch (error) {
      // Error sending email
      formStatus.textContent =
        currentLang === "en"
          ? "Failed to send message. Please try again."
          : "Det gick inte att skicka meddelandet. Försök igen.";
      formStatus.className = "form-status error";
    } finally {
      // Restore button state
      submitBtn.textContent = originalText;
      submitBtn.disabled = false;
    }
  });

  // Add ESC key to close modal
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && contactModal.classList.contains("active")) {
      contactModal.classList.remove("active");
      document.body.style.overflow = "";
    }
  });

  function initCollapsibleContent() {
    const projectDescriptions = document.querySelectorAll(".project-content p");

    projectDescriptions.forEach((paragraph) => {
      if (paragraph.textContent.length > 20) {
        // Create wrapper for the collapsible content
        const wrapper = document.createElement("div");
        wrapper.className = "collapsible-wrapper";

        // Create the collapsible content container
        const collapsible = document.createElement("div");
        collapsible.className = "collapsible-content";

        // Move the paragraph into the collapsible div
        paragraph.parentNode.insertBefore(wrapper, paragraph);
        collapsible.appendChild(paragraph);
        wrapper.appendChild(collapsible);

        // Create the toggle button
        const toggleBtn = document.createElement("button");
        toggleBtn.className = "toggle-btn";
        toggleBtn.innerHTML = '<i class="fas fa-chevron-down"></i>';
        wrapper.appendChild(toggleBtn);

        // Add click event to toggle button
        toggleBtn.addEventListener("click", () => {
          collapsible.classList.toggle("expanded");
          toggleBtn.classList.toggle("expanded");
        });
      }
    });
  }
  initCollapsibleContent();
});
